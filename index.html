<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="FrançaisIA - Plateforme d'apprentissage de la grammaire française">
    <meta name="author" content="Université de Mostaganem - Master Sciences du Langage">
    <title>FrançaisIA - Apprentissage de la Grammaire Française</title>

    <style>
        /* ==========================================
           FrançaisIA - Styles CSS
           Projet Master Sciences du Langage
           ========================================== */

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #2563eb;
            --success: #059669;
            --warning: #d97706;
            --danger: #dc2626;
            --dark: #1f2937;
            --light: #f3f4f6;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            line-height: 1.6;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        /* Header */
        header {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo-icon {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, var(--primary), #8b5cf6);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2em;
            font-weight: 900;
            color: white;
            font-family: Georgia, serif;
            font-style: italic;
        }

        .logo-text h1 {
            font-size: 1.8em;
            color: var(--dark);
            margin-bottom: 5px;
        }

        .logo-text p {
            color: #6b7280;
            font-size: 0.95em;
        }

        .logo-text .university {
            font-size: 0.85em;
            color: #9ca3af;
            font-style: italic;
            margin-top: 3px;
        }

        .header-actions {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 10px 20px;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.9em;
            color: white;
            transition: all 0.3s;
        }

        .btn-primary { background: var(--primary); }
        .btn-success { background: var(--success); }
        .btn-warning { background: var(--warning); }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }

        /* Dashboard */
        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }

        .stat-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.08);
            display: flex;
            align-items: center;
            gap: 15px;
            transition: transform 0.3s;
        }

        .stat-card:hover {
            transform: translateY(-3px);
        }

        .stat-icon {
            width: 60px;
            height: 60px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2em;
        }

        .stat-icon.primary { background: linear-gradient(135deg, var(--primary), #3b82f6); }
        .stat-icon.success { background: linear-gradient(135deg, var(--success), #10b981); }
        .stat-icon.warning { background: linear-gradient(135deg, var(--warning), #f59e0b); }
        .stat-icon.info { background: linear-gradient(135deg, #3b82f6, #60a5fa); }

        .stat-content h3 {
            font-size: 2em;
            color: var(--dark);
            font-weight: 700;
        }

        .stat-content p {
            color: #6b7280;
            font-size: 0.9em;
        }

        /* Level Card */
        .level-card {
            background: white;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.08);
        }

        .level-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .level-badge {
            padding: 8px 20px;
            border-radius: 20px;
            font-weight: 700;
            color: white;
            font-size: 0.9em;
        }

        .level-badge.debutant { background: var(--warning); }
        .level-badge.intermediaire { background: var(--primary); }
        .level-badge.avance { background: var(--success); }

        .progress-bar-container {
            background: var(--light);
            border-radius: 10px;
            height: 30px;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), #8b5cf6);
            transition: width 1s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 700;
            font-size: 0.9em;
        }

        /* Recommendations */
        .recommendations {
            background: linear-gradient(135deg, var(--primary), #8b5cf6);
            color: white;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 4px 15px rgba(37, 99, 235, 0.3);
        }

        .recommendations h2 {
            font-size: 1.5em;
            margin-bottom: 10px;
        }

        .recommendations p {
            opacity: 0.9;
            margin-bottom: 15px;
        }

        .suggestion {
            background: rgba(255,255,255,0.15);
            padding: 18px;
            border-radius: 10px;
            backdrop-filter: blur(10px);
        }

        /* Lessons */
        .lessons-section {
            background: white;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.08);
        }

        .lessons-section h2 {
            font-size: 1.6em;
            color: var(--dark);
            margin-bottom: 10px;
        }

        .lessons-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .lesson-card {
            background: linear-gradient(135deg, #f9fafb, var(--light));
            border-radius: 12px;
            padding: 25px;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid #e5e7eb;
        }

        .lesson-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.12);
            border-color: var(--primary);
        }

        .lesson-icon {
            font-size: 3em;
            margin-bottom: 15px;
        }

        .lesson-title {
            font-size: 1.4em;
            color: var(--dark);
            margin-bottom: 10px;
            font-weight: 700;
        }

        .lesson-description {
            color: #6b7280;
            font-size: 0.9em;
            margin-bottom: 15px;
            line-height: 1.5;
        }

        .lesson-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-top: 15px;
            border-top: 2px solid #e5e7eb;
        }

        .lesson-difficulty {
            padding: 5px 14px;
            border-radius: 8px;
            font-size: 0.8em;
            font-weight: 700;
        }

        .difficulty-facile { background: #d1fae5; color: #065f46; }
        .difficulty-moyen { background: #fef3c7; color: #92400e; }
        .difficulty-difficile { background: #fee2e2; color: #991b1b; }

        /* Lesson Container */
        .lesson-container {
            display: none;
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.08);
        }

        .lesson-container.active {
            display: block;
        }

        .back-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            font-size: 1em;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }

        .back-btn:hover {
            background: #1d4ed8;
        }

        /* Questions */
        .question-card {
            background: linear-gradient(135deg, #f9fafb, var(--light));
            border-radius: 12px;
            padding: 30px;
            margin: 20px 0;
        }

        .question-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .question-number {
            width: 50px;
            height: 50px;
            background: var(--primary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.3em;
            font-weight: 800;
        }

        .question-text h3 {
            font-size: 1.3em;
            color: var(--dark);
            line-height: 1.5;
        }

        .options-grid {
            display: grid;
            gap: 12px;
        }

        .option {
            background: white;
            padding: 18px;
            border-radius: 10px;
            border: 2px solid #e5e7eb;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 1em;
        }

        .option:hover {
            border-color: var(--primary);
            transform: translateX(3px);
        }

        .option.correct {
            background: linear-gradient(135deg, #d1fae5, #a7f3d0);
            border-color: var(--success);
        }

        .option.wrong {
            background: linear-gradient(135deg, #fee2e2, #fecaca);
            border-color: var(--danger);
        }

        .explanation-box {
            background: linear-gradient(135deg, #dbeafe, #bfdbfe);
            border-left: 4px solid var(--primary);
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            display: none;
        }

        .explanation-box.show {
            display: block;
        }

        .explanation-box h4 {
            color: var(--primary);
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        .explanation-box p {
            color: var(--dark);
            line-height: 1.6;
        }

        /* Performance Report */
        .performance-report {
            display: none;
            text-align: center;
            padding: 30px;
        }

        .performance-report.show {
            display: block;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            z-index: 1000;
            padding: 20px;
            overflow-y: auto;
        }

        .modal.show {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: white;
            border-radius: 15px;
            padding: 30px;
            max-width: 800px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-content h2 {
            color: var(--primary);
            font-size: 2em;
            margin-bottom: 20px;
        }

        .modal-content h3 {
            color: var(--dark);
            font-size: 1.3em;
            margin-top: 20px;
            margin-bottom: 10px;
        }

        .about-section {
            margin-bottom: 25px;
        }

        .about-section ul {
            margin-left: 20px;
            color: #4b5563;
        }

        .about-section li {
            margin-bottom: 8px;
        }

        .close-modal {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--danger);
            border: none;
            cursor: pointer;
            font-size: 1.5em;
            color: white;
            float: right;
            transition: all 0.3s;
        }

        .close-modal:hover {
            transform: rotate(90deg);
        }

        /* Responsive */
        @media (max-width: 768px) {
            header {
                flex-direction: column;
                text-align: center;
            }

            .lessons-grid,
            .dashboard {
                grid-template-columns: 1fr;
            }

            .header-actions {
                width: 100%;
            }

            .btn {
                flex: 1;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">
                <div class="logo-icon">F</div>
                <div class="logo-text">
                    <h1>FrançaisIA</h1>
                    <p>Plateforme d'Apprentissage de la Grammaire Française</p>
                    <p class="university">Projet Master - Sciences du Langage - Université de Mostaganem</p>
                </div>
            </div>
            <div class="header-actions">
                <button class="btn btn-primary" onclick="showAbout()">📖 À propos</button>
                <button class="btn btn-success" onclick="exportData()">💾 Exporter données</button>
                <button class="btn btn-warning" onclick="resetData()">🔄 Réinitialiser</button>
            </div>
        </header>

        <!-- Modal À propos -->
        <div class="modal" id="aboutModal">
            <div class="modal-content">
                <button class="close-modal" onclick="closeAbout()">×</button>
                <h2>📖 À propos du projet</h2>
                <div class="about-section">
                    <h3>🎓 Contexte académique</h3>
                    <p><strong>Titre:</strong> Développement d'une plateforme d'apprentissage adaptatif de la grammaire française</p>
                    <p><strong>Programme:</strong> Master Sciences du Langage</p>
                    <p><strong>Institution:</strong> Université de Mostaganem - Département des Langues Étrangères</p>
                    <p><strong>Année:</strong> 2024-2025</p>
                </div>

                <div class="about-section">
                    <h3>🎯 Objectifs du projet</h3>
                    <ul>
                        <li>Développer un outil d'apprentissage de la grammaire française</li>
                        <li>Analyser les interférences linguistiques arabe-français</li>
                        <li>Proposer des recommandations personnalisées basées sur les erreurs</li>
                        <li>Collecter des données pour la recherche en didactique du FLE</li>
                    </ul>
                </div>

                <div class="about-section">
                    <h3>📚 Contenu pédagogique</h3>
                    <p><strong>150 questions</strong> réparties sur <strong>10 modules</strong> grammaticaux</p>
                </div>

                <div class="about-section">
                    <h3>🔬 Cadre théorique</h3>
                    <ul>
                        <li>Linguistique appliquée au FLE</li>
                        <li>Analyse des erreurs</li>
                        <li>Analyse contrastive arabe-français</li>
                        <li>Didactique des langues étrangères</li>
                    </ul>
                </div>
            </div>
        </div>

        <div id="mainDashboard">
            <div class="dashboard">
                <div class="stat-card">
                    <div class="stat-icon primary">📊</div>
                    <div class="stat-content">
                        <h3 id="totalQuestions">0</h3>
                        <p>Questions traitées</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon success">✅</div>
                    <div class="stat-content">
                        <h3 id="correctAnswers">0</h3>
                        <p>Réponses correctes</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon warning">🎯</div>
                    <div class="stat-content">
                        <h3 id="accuracyRate">0%</h3>
                        <p>Taux de réussite</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon info">⚡</div>
                    <div class="stat-content">
                        <h3 id="streak">0</h3>
                        <p>Série actuelle</p>
                    </div>
                </div>
            </div>

            <div class="level-card">
                <div class="level-header">
                    <div>
                        <h2>Votre Progression</h2>
                        <p style="color: #6b7280;">Continuez à pratiquer pour progresser</p>
                    </div>
                    <div class="level-badge debutant" id="levelBadge">Débutant</div>
                </div>
                <div class="progress-bar-container">
                    <div class="progress-bar" id="levelProgress" style="width: 0%">0%</div>
                </div>
            </div>

            <div class="recommendations">
                <h2>🎯 Recommandations Personnalisées</h2>
                <p>Suggestions adaptées à vos besoins d'apprentissage</p>
                <div class="suggestion" id="suggestions">
                    <strong>👋 Bienvenue !</strong><br>
                    Commencez par sélectionner un module ci-dessous pour débuter votre apprentissage.
                </div>
            </div>

            <div class="lessons-section">
                <h2>📚 Modules d'Apprentissage</h2>
                <p style="color: #6b7280; margin-bottom: 20px;">150 questions réparties sur 10 modules grammaticaux</p>
                <div class="lessons-grid" id="lessonsGrid"></div>
            </div>
        </div>

        <div class="lesson-container" id="lessonContainer">
            <button class="back-btn" onclick="exitLesson()">← Retour au tableau de bord</button>
            <h3 id="currentLessonTitle" style="margin: 25px 0; font-size: 1.8em;"></h3>
            <p id="lessonProgressText" style="color: #6b7280; margin-bottom: 20px;"></p>
            <div id="questionArea"></div>
            <button class="btn btn-primary" id="nextBtn" onclick="nextQuestion()" style="display: none; margin-top: 20px;">
                Question suivante →
            </button>
            <div class="performance-report" id="performanceReport"></div>
        </div>
    </div>

    <script>
        // البيانات والمنطق البرمجي
        const LESSONS = [
            {id: 'noms', title: 'Les Noms', icon: '📦', description: 'Identification et classification', difficulty: 'facile'},
            {id: 'verbes', title: 'Les Verbes', icon: '🏃', description: 'Reconnaissance et utilisation', difficulty: 'moyen'},
            {id: 'adjectifs', title: 'Les Adjectifs', icon: '🎨', description: 'Accord en genre et nombre', difficulty: 'moyen'},
            {id: 'determinants', title: 'Les Déterminants', icon: '🔤', description: 'Articles et déterminants', difficulty: 'difficile'},
            {id: 'prepositions', title: 'Les Prépositions', icon: '➡️', description: 'Lieu et temps', difficulty: 'difficile'},
            {id: 'pronoms', title: 'Les Pronoms', icon: '👥', description: 'Pronoms personnels', difficulty: 'moyen'},
            {id: 'conjugaison', title: 'La Conjugaison', icon: '🔄', description: 'Temps principaux', difficulty: 'difficile'},
            {id: 'phrases', title: 'Structure Phrase', icon: '✏️', description: 'Construction correcte', difficulty: 'moyen'},
            {id: 'orthographe', title: 'L\'Orthographe', icon: '📝', description: 'Erreurs courantes', difficulty: 'difficile'},
            {id: 'temps', title: 'Les Temps', icon: '⏰', description: 'Distinction temporelle', difficulty: 'facile'}
        ];

        const QUESTIONS = {
            noms: [
                {q: "Dans 'Le chat noir dort', quel est le nom?", o: ["Le", "chat", "noir", "dort"], c: 1, e: "'Chat' est un nom commun désignant un animal."},
                {q: "Quel mot est un nom propre?", o: ["ville", "Paris", "maison", "rue"], c: 1, e: "'Paris' est un nom propre avec majuscule."},
                {q: "Combien de noms dans 'Marie joue au ballon'?", o: ["1", "2", "3", "0"], c: 1, e: "Deux noms: 'Marie' et 'ballon'."},
                {q: "Quel nom désigne une idée abstraite?", o: ["table", "bonheur", "chien", "Paris"], c: 1, e: "'Bonheur' est un nom abstrait."},
                {q: "'Professeur' désigne:", o: ["un lieu", "une personne", "une chose", "une action"], c: 1, e: "'Professeur' est un nom de personne."},
                {q: "Le nom propre dans 'L'Algérie est belle':", o: ["pays", "belle", "Algérie", "est"], c: 2, e: "'Algérie' est un nom propre de pays."},
                {q: "Quel nom est féminin?", o: ["garçon", "fleur", "livre", "stylo"], c: 1, e: "'Fleur' est féminin."},
                {q: "Le pluriel de 'cheval':", o: ["chevals", "chevaux", "chevaus", "chevales"], c: 1, e: "Pluriel irrégulier: chevaux."},
                {q: "Quel mot n'est PAS un nom?", o: ["courage", "rapidement", "soleil", "enfance"], c: 1, e: "'Rapidement' est un adverbe."},
                {q: "Dans 'Le livre de Sophie', qui possède?", o: ["livre", "de", "Sophie", "Le"], c: 2, e: "'Sophie' indique la possession."},
                {q: "Un nom collectif désigne:", o: ["une chose", "un groupe", "une action", "une qualité"], c: 1, e: "Exemple: foule, équipe."},
                {q: "Féminin de 'directeur':", o: ["directeure", "directrice", "directeuse", "directeuresse"], c: 1, e: "Le féminin est 'directrice'."},
                {q: "'Soleil' est un nom:", o: ["propre", "commun", "abstrait", "collectif"], c: 1, e: "'Soleil' est un nom commun."},
                {q: "Dans 'Trois pommes', 'pommes' est:", o: ["verbe", "nom pluriel", "adjectif", "singulier"], c: 1, e: "'Pommes' est au pluriel."},
                {q: "'Amitié' exprime:", o: ["objet", "sentiment", "lieu", "personne"], c: 1, e: "Nom abstrait exprimant un sentiment."}
            ],
            verbes: [
                {q: "Dans 'Pierre court vite', le verbe est:", o: ["Pierre", "court", "vite", "aucun"], c: 1, e: "'Court' est un verbe d'action."},
                {q: "Quel est le verbe d'état?", o: ["courir", "manger", "être", "danser"], c: 2, e: "'Être' est un verbe d'état."},
                {q: "'Je chante': 'chante' est:", o: ["nom", "verbe", "adjectif", "adverbe"], c: 1, e: "'Chante' est un verbe conjugué."},
                {q: "L'infinitif de 'fais' est:", o: ["faisant", "faire", "fait", "faisais"], c: 1, e: "L'infinitif de 'fais' est 'faire'."},
                {q: "Quel verbe exprime une action?", o: ["être", "sembler", "paraître", "marcher"], c: 3, e: "'Marcher' exprime une action."},
                {q: "Dans 'Il a mangé', l'auxiliaire est:", o: ["Il", "a", "mangé", "aucun"], c: 1, e: "'A' est l'auxiliaire avoir."},
                {q: "'Ils parlent': nombre de verbes?", o: ["0", "1", "2", "3"], c: 1, e: "Un seul verbe: 'parlent'."},
                {q: "Le verbe dans 'Je suis content':", o: ["Je", "suis", "content", "aucun"], c: 1, e: "'Suis' est le verbe être."},
                {q: "Quel verbe n'exprime pas d'action?", o: ["courir", "devenir", "sauter", "jouer"], c: 1, e: "'Devenir' est un verbe d'état."},
                {q: "'Nous avons chanté': temps utilisé?", o: ["présent", "futur", "passé composé", "imparfait"], c: 2, e: "Passé composé."},
                {q: "L'infinitif de 'vont' est:", o: ["aller", "allant", "allé", "va"], c: 0, e: "L'infinitif de 'vont' est 'aller'."},
                {q: "'Elle danse': fonction du verbe?", o: ["sujet", "action", "complément", "adjectif"], c: 1, e: "Le verbe exprime l'action."},
                {q: "Quel est l'auxiliaire de 'être'?", o: ["avoir", "être", "faire", "aller"], c: 1, e: "On utilise 'être' comme auxiliaire."},
                {q: "Dans 'Tu finiras demain', le verbe est au:", o: ["présent", "passé", "futur", "conditionnel"], c: 2, e: "'Finiras' est au futur."},
                {q: "'Ils étaient': temps du verbe?", o: ["présent", "imparfait", "futur", "passé composé"], c: 1, e: "'Étaient' est à l'imparfait."}
            ],
            adjectifs: [
                {q: "'Un chat noir': l'adjectif est:", o: ["Un", "chat", "noir", "aucun"], c: 2, e: "'Noir' qualifie le chat."},
                {q: "Féminin de 'grand':", o: ["grande", "grand", "grands", "grandes"], c: 0, e: "On ajoute 'e': grande."},
                {q: "Pluriel de 'beau':", o: ["beaux", "beaus", "beautx", "beaulx"], c: 0, e: "Pluriel irrégulier: beaux."},
                {q: "'Une fleur belle': accord correct?", o: ["Oui", "Non, 'bel'", "Non, 'beau'", "Non, 'belles'"], c: 0, e: "'Belle' s'accorde avec 'fleur'."},
                {q: "Dans 'Des chiens gentils', l'adjectif:", o: ["chiens", "Des", "gentils", "aucun"], c: 2, e: "'Gentils' qualifie les chiens."},
                {q: "Féminin de 'heureux':", o: ["heureuse", "heureuxe", "heureuses", "heureux"], c: 0, e: "On transforme -eux en -euse."},
                {q: "'Un livre intéressant': l'adjectif se place:", o: ["avant", "après", "les deux", "aucun"], c: 1, e: "La plupart se placent après."},
                {q: "Pluriel de 'national':", o: ["nationals", "nationaux", "nationales", "national"], c: 1, e: "Les adjectifs en -al font -aux."},
                {q: "'Des filles intelligentes': accord correct?", o: ["Oui", "Non, intelligent", "Non, intelligents", "Non, intelligente"], c: 0, e: "'Intelligentes' s'accorde."},
                {q: "L'adjectif de couleur 'orange':", o: ["s'accorde", "ne s'accorde pas", "parfois", "selon contexte"], c: 1, e: "Les couleurs issues de noms sont invariables."},
                {q: "Féminin de 'vieux':", o: ["vieille", "vieuxe", "vieuse", "vieulle"], c: 0, e: "Forme irrégulière: vieille."},
                {q: "'Un bon livre': l'adjectif se place:", o: ["après", "avant", "les deux", "nulle part"], c: 1, e: "Certains courts se placent avant."},
                {q: "Pluriel de 'bleu':", o: ["bleu", "bleus", "bleues", "bleuxs"], c: 1, e: "Pluriel régulier: bleus."},
                {q: "'Des robes blanches': genre et nombre?", o: ["masculin singulier", "féminin singulier", "masculin pluriel", "féminin pluriel"], c: 3, e: "Féminin pluriel."},
                {q: "L'adjectif 'français' au féminin:", o: ["française", "françaisse", "français", "francaise"], c: 0, e: "On ajoute 'e': française."}
            ],
            determinants: [
                {q: "Dans 'Le chat', 'le' est:", o: ["nom", "verbe", "article défini", "adjectif"], c: 2, e: "'Le' est un article défini masculin."},
                {q: "Article indéfini féminin:", o: ["un", "une", "le", "la"], c: 1, e: "'Une' est l'article indéfini féminin."},
                {q: "'Les enfants': type de déterminant?", o: ["défini", "indéfini", "possessif", "démonstratif"], c: 0, e: "'Les' est un article défini pluriel."},
                {q: "Quel est un déterminant possessif?", o: ["le", "mon", "ce", "des"], c: 1, e: "'Mon' indique la possession."},
                {q: "'Cette maison': type de déterminant?", o: ["défini", "indéfini", "possessif", "démonstratif"], c: 3, e: "'Cette' est démonstratif."},
                {q: "Article devant 'arbre':", o: ["le", "la", "l'", "les"], c: 2, e: "Devant une voyelle: l'arbre."},
                {q: "'Des livres': type d'article?", o: ["défini", "indéfini", "partitif", "aucun"], c: 1, e: "'Des' est l'article indéfini pluriel."},
                {q: "Déterminant possessif pour 'ta' au pluriel:", o: ["ta", "tes", "ton", "tas"], c: 1, e: "Pluriel de 'ta': tes."},
                {q: "'Ce garçon' au féminin:", o: ["ce fille", "cette fille", "cet fille", "ces fille"], c: 1, e: "Féminin de 'ce': cette."},
                {q: "Article contracté de 'à + le':", o: ["à le", "au", "aux", "al"], c: 1, e: "'À + le' devient 'au'."},
                {q: "'Son livre': genre du possesseur?", o: ["masculin", "féminin", "indéterminé", "neutre"], c: 2, e: "'Son' ne révèle pas le genre."},
                {q: "Déterminant devant 'école':", o: ["le", "la", "l'", "les"], c: 2, e: "Devant une voyelle féminine: l'école."},
                {q: "'Mes amis': personne du possesseur?", o: ["1ère", "2ème", "3ème", "aucune"], c: 0, e: "'Mes' indique la 1ère personne."},
                {q: "Article partitif masculin:", o: ["du", "de la", "des", "de l'"], c: 0, e: "'Du' est l'article partitif masculin."},
                {q: "'Leurs maisons': nombre de possesseurs?", o: ["un", "deux ou plus", "indéterminé", "aucun"], c: 1, e: "'Leurs' indique plusieurs possesseurs."}
            ],
            prepositions: [
                {q: "Dans 'Je vais à Paris', la préposition est:", o: ["Je", "vais", "à", "Paris"], c: 2, e: "'À' est une préposition de direction."},
                {q: "Préposition de lieu:", o: ["depuis", "pendant", "dans", "avant"], c: 2, e: "'Dans' indique le lieu."},
                {q: "'Le livre de Marie': fonction de 'de'?", o: ["temps", "lieu", "possession", "manière"], c: 2, e: "'De' indique la possession."},
                {q: "Erreur arabe: 'Je vais ... école'", o: ["à l'", "dans l'", "sur l'", "de l'"], c: 0, e: "En français: 'à l'école'."},
                {q: "'Sur la table': type de préposition?", o: ["temps", "lieu", "manière", "cause"], c: 1, e: "'Sur' indique la position."},
                {q: "Préposition de temps:", o: ["avec", "sans", "pendant", "pour"], c: 2, e: "'Pendant' indique la durée."},
                {q: "'Je viens de Mostaganem': 'de' indique:", o: ["temps", "origine", "manière", "but"], c: 1, e: "'De' indique la provenance."},
                {q: "Erreur: 'Je suis ... la maison'", o: ["à", "dans", "sur", "de"], c: 1, e: "Correct: 'dans la maison'."},
                {q: "'Avec mes amis': type de préposition?", o: ["temps", "lieu", "accompagnement", "cause"], c: 2, e: "'Avec' indique l'accompagnement."},
                {q: "Préposition après 'aller':", o: ["dans", "à", "de", "sur"], c: 1, e: "On dit 'aller à' un lieu."},
                {q: "'Depuis hier': 'depuis' exprime:", o: ["lieu", "temps", "manière", "but"], c: 1, e: "'Depuis' indique le point de départ temporel."},
                {q: "'Par la fenêtre': fonction de 'par'?", o: ["temps", "passage", "possession", "cause"], c: 1, e: "'Par' indique le passage."},
                {q: "Erreur: 'Je parle ... français'", o: ["à", "en", "de", "avec"], c: 1, e: "Correct: 'en français'."},
                {q: "'Pour toi': fonction de 'pour'?", o: ["temps", "but", "lieu", "manière"], c: 1, e: "'Pour' indique le destinataire."},
                {q: "'Chez le médecin': 'chez' signifie:", o: ["temps", "domicile/bureau", "manière", "cause"], c: 1, e: "'Chez' indique le domicile ou bureau."}
            ],
            pronoms: [
                {q: "'Je parle': 'je' est:", o: ["nom", "verbe", "pronom", "adjectif"], c: 2, e: "'Je' est un pronom personnel sujet."},
                {q: "Pronom complément pour 'à moi':", o: ["je", "me", "moi", "mon"], c: 1, e: "'Me' est le pronom complément."},
                {q: "'Il la voit': 'la' remplace:", o: ["masculin", "féminin", "pluriel", "neutre"], c: 1, e: "'La' remplace un féminin singulier."},
                {q: "Pronom possessif de 'mon livre':", o: ["le mien", "la mienne", "les miens", "le mienn"], c: 0, e: "'Le mien' remplace 'mon livre'."},
                {q: "'Nous leur parlons': 'leur' signifie:", o: ["à eux", "eux", "leurs", "pour eux"], c: 0, e: "'Leur' = à eux/elles."},
                {q: "Pronom sujet 3ème personne pluriel:", o: ["nous", "vous", "ils", "je"], c: 2, e: "'Ils/elles' sont 3ème personne pluriel."},
                {q: "'Je le vois': 'le' remplace:", o: ["féminin", "masculin", "pluriel", "rien"], c: 1, e: "'Le' remplace un masculin singulier."},
                {q: "'C'est à elle': type de pronom pour 'elle'?", o: ["sujet", "complément direct", "tonique", "possessif"], c: 2, e: "'Elle' après préposition est tonique."},
                {q: "Pronom réfléchi pour 'tu':", o: ["te", "toi", "ton", "ta"], c: 0, e: "'Te' est le pronom réfléchi de 'tu'."},
                {q: "'Lesquels préfères-tu?': type de pronom?", o: ["personnel", "possessif", "interrogatif", "démonstratif"], c: 2, e: "'Lesquels' est interrogatif."},
                {q: "'Celui de Marie': type de pronom?", o: ["personnel", "possessif", "démonstratif", "réfléchi"], c: 2, e: "'Celui' est démonstratif."},
                {q: "'Nous vous voyons': 'vous' est:", o: ["sujet", "complément direct", "tonique", "possessif"], c: 1, e: "'Vous' est COD."},
                {q: "Pronom pour remplacer 'les livres':", o: ["le", "la", "les", "leur"], c: 2, e: "'Les' remplace un pluriel."},
                {q: "'Il y va': 'y' remplace:", o: ["personne", "lieu", "chose", "temps"], c: 1, e: "'Y' remplace un lieu."},
                {q: "'J'en veux': 'en' remplace:", o: ["personne", "lieu", "quantité", "temps"], c: 2, e: "'En' remplace une quantité."}
            ],
            conjugaison: [
                {q: "'Je chante': temps du verbe?", o: ["passé", "présent", "futur", "conditionnel"], c: 1, e: "'Chante' est au présent."},
                {q: "Passé composé de 'manger' avec 'je':", o: ["je mange", "j'ai mangé", "je mangeais", "je mangerai"], c: 1, e: "Auxiliaire avoir + participe passé."},
                {q: "'Nous irons': temps du verbe?", o: ["présent", "imparfait", "futur", "conditionnel"], c: 2, e: "'Irons' est au futur simple."},
                {q: "Imparfait de 'être' avec 'il':", o: ["il est", "il était", "il sera", "il fut"], c: 1, e: "'Était' est l'imparfait."},
                {q: "'Tu finiras': groupe du verbe?", o: ["1er", "2ème", "3ème", "auxiliaire"], c: 1, e: "'Finir' est du 2ème groupe."},
                {q: "Participe passé de 'faire':", o: ["faisant", "fait", "fais", "faire"], c: 1, e: "Le participe passé de 'faire' est 'fait'."},
                {q: "'Ils ont été': temps utilisé?", o: ["présent", "imparfait", "passé composé", "plus-que-parfait"], c: 2, e: "Passé composé."},
                {q: "Présent de 'aller' avec 'nous':", o: ["nous allez", "nous allons", "nous irons", "nous allions"], c: 1, e: "Forme irrégulière: nous allons."},
                {q: "'Elle aurait voulu': temps du verbe?", o: ["futur", "conditionnel passé", "plus-que-parfait", "subjonctif"], c: 1, e: "Conditionnel passé."},
                {q: "Futur de 'avoir' avec 'tu':", o: ["tu as", "tu avais", "tu auras", "tu aurais"], c: 2, e: "'Auras' est le futur."},
                {q: "Verbe du 1er groupe:", o: ["finir", "chanter", "voir", "faire"], c: 1, e: "Les verbes en -er sont du 1er groupe."},
                {q: "'Vous faisiez': temps du verbe?", o: ["présent", "imparfait", "futur", "passé simple"], c: 1, e: "'Faisiez' est à l'imparfait."},
                {q: "Auxiliaire avec 'venir' au passé composé:", o: ["avoir", "être", "les deux", "aucun"], c: 1, e: "'Venir' se conjugue avec 'être'."},
                {q: "'Il faut que je parte': mode du verbe?", o: ["indicatif", "subjonctif", "conditionnel", "impératif"], c: 1, e: "Après 'il faut que': subjonctif."},
                {q: "Impératif de 'être' avec 'tu':", o: ["es", "sois", "soit", "être"], c: 1, e: "L'impératif de 'être': sois."}
            ],
            phrases: [
                {q: "Ordre correct en français:", o: ["Verbe-Sujet-Complément", "Sujet-Verbe-Complément", "Complément-Verbe-Sujet", "Verbe-Complément-Sujet"], c: 1, e: "Structure: Sujet + Verbe + Complément."},
                {q: "'Marie mange une pomme': fonction de 'une pomme'?", o: ["sujet", "verbe", "complément d'objet direct", "complément circonstanciel"], c: 2, e: "'Une pomme' est le COD."},
                {q: "Phrase interrogative correcte:", o: ["Tu viens?", "Viens tu?", "Tu viens-tu?", "Viens-tu tu?"], c: 0, e: "Interrogation avec intonation."},
                {q: "'Je ne veux pas': place de la négation?", o: ["avant", "après", "autour du verbe", "en fin"], c: 2, e: "'Ne...pas' encadre le verbe."},
                {q: "Type de phrase: 'Comme c'est beau!'", o: ["déclarative", "interrogative", "exclamative", "impérative"], c: 2, e: "Point d'exclamation = exclamative."},
                {q: "Phrase impérative correcte:", o: ["Tu ranges", "Range", "Tu range", "Ranges"], c: 1, e: "À l'impératif: 'Range'."},
                {q: "'Hier, j'ai mangé': fonction de 'hier'?", o: ["sujet", "COD", "complément circonstanciel", "attribut"], c: 2, e: "'Hier' est complément circonstanciel de temps."},
                {q: "Ponctuation en fin de question:", o: [".", "!", "?", ","], c: 2, e: "Les questions se terminent par '?'."},
                {q: "'Elle est belle': fonction de 'belle'?", o: ["sujet", "COD", "attribut", "complément"], c: 2, e: "'Belle' est attribut du sujet."},
                {q: "Interrogation avec inversion correcte:", o: ["Viens-tu?", "Tu-viens?", "Viens tu?", "Vien-tu?"], c: 0, e: "Inversion: verbe-trait d'union-pronom."},
                {q: "'Ne...jamais' exprime:", o: ["affirmation", "négation", "interrogation", "exclamation"], c: 1, e: "'Ne...jamais' est une négation."},
                {q: "Phrase déclarative correcte:", o: ["Il mange.", "Mange-t-il?", "Mange!", "Qu'il mange!"], c: 0, e: "Phrase déclarative avec point."},
                {q: "'Où vas-tu?': type de mot interrogatif?", o: ["pronom", "adverbe", "adjectif", "nom"], c: 1, e: "'Où' est un adverbe interrogatif."},
                {q: "Place de l'adverbe 'souvent':", o: ["début", "après le verbe", "avant le sujet", "fin"], c: 1, e: "Les adverbes après le verbe."},
                {q: "'Est-ce que tu viens?': type d'interrogation?", o: ["totale", "partielle", "indirecte", "oratoire"], c: 0, e: "Interrogation totale (oui/non)."}
            ],
            orthographe: [
                {q: "Orthographe correcte:", o: ["à", "a", "as", "ah"], c: 0, e: "Préposition: 'à' avec accent."},
                {q: "'Et' ou 'est'? : 'Il ... grand'", o: ["et", "est", "es", "ait"], c: 1, e: "Verbe être: 'est'."},
                {q: "Pluriel de 'cheval':", o: ["chevals", "chevaux", "chevaus", "chevales"], c: 1, e: "Pluriel irrégulier: 'chevaux'."},
                {q: "Accent correct: 'él...ve'", o: ["é", "è", "ê", "e"], c: 1, e: "'Élève' prend un accent grave."},
                {q: "'Son' ou 'sont'? : 'Ils ... partis'", o: ["son", "sont", "sons", "sond"], c: 1, e: "Verbe être au pluriel: 'sont'."},
                {q: "Orthographe: 'appeller' ou 'appeler'?", o: ["appeller", "appeler", "apeller", "apelller"], c: 1, e: "Correct: 'appeler' (un seul 'l')."},
                {q: "'Ça' ou 'sa'? : '... maison'", o: ["ça", "sa", "çà", "sà"], c: 1, e: "Possessif: 'sa'."},
                {q: "Lettre muette dans 'temps':", o: ["t", "e", "m", "s"], c: 3, e: "Le 's' final est muet."},
                {q: "'Eau', 'au' ou 'o'? : 'B...coup'", o: ["eau", "au", "o", "ô"], c: 1, e: "'Beaucoup' s'écrit avec 'au'."},
                {q: "Accent sur 'ou'? : 'où es-tu?'", o: ["oui", "non", "parfois", "selon"], c: 0, e: "'Où' (lieu) prend un accent grave."},
                {q: "'Ces' ou 'ses'? : '... enfants (à lui)'", o: ["ces", "ses", "c'est", "sais"], c: 1, e: "Possessif: 'ses' enfants."},
                {q: "Orthographe correcte:", o: ["déveloper", "développer", "developer", "develloper"], c: 1, e: "Correct: 'développer' (pp)."},
                {q: "'C'est' ou 'ses'? : '... mon ami'", o: ["c'est", "ses", "ces", "sais"], c: 0, e: "Démonstratif + être: 'c'est'."},
                {q: "Féminin de 'blanc':", o: ["blance", "blanque", "blanche", "blanc"], c: 2, e: "Féminin: 'blanche'."},
                {q: "'Leur' ou 'leurs'? : '... maison' (une seule)", o: ["leur", "leurs", "l'heure", "l'eur"], c: 0, e: "'Leur' (singulier) maison."}
            ],
            temps: [
                {q: "'Je mange': temps du verbe?", o: ["passé", "présent", "futur", "conditionnel"], c: 1, e: "'Mange' indique le présent."},
                {q: "Indicateur de futur:", o: ["hier", "demain", "aujourd'hui", "avant"], c: 1, e: "'Demain' indique le futur."},
                {q: "'J'ai mangé': temps?", o: ["présent", "passé", "futur", "conditionnel"], c: 1, e: "Passé composé = action passée."},
                {q: "Indicateur de passé:", o: ["bientôt", "hier", "demain", "maintenant"], c: 1, e: "'Hier' indique le passé."},
                {q: "'Je mangerai': temps?", o: ["présent", "passé", "futur", "imparfait"], c: 2, e: "'Mangerai' est au futur."},
                {q: "'Maintenant' indique quel temps?", o: ["passé", "présent", "futur", "conditionnel"], c: 1, e: "'Maintenant' = moment présent."},
                {q: "'Je mangeais': temps?", o: ["présent", "imparfait", "futur", "passé simple"], c: 1, e: "'Mangeais' est à l'imparfait."},
                {q: "Action terminée dans le passé:", o: ["présent", "imparfait", "passé composé", "futur"], c: 2, e: "Le passé composé = action terminée."},
                {q: "'Autrefois' indique:", o: ["présent", "passé", "futur", "conditionnel"], c: 1, e: "'Autrefois' = passé."},
                {q: "Temps pour une habitude passée:", o: ["présent", "imparfait", "passé composé", "futur"], c: 1, e: "L'imparfait = habitude passée."},
                {q: "'Bientôt' indique:", o: ["passé", "présent", "futur proche", "conditionnel"], c: 2, e: "'Bientôt' = futur proche."},
                {q: "'Pendant que' + quel temps?", o: ["présent", "imparfait", "futur", "conditionnel"], c: 1, e: "Action en cours: imparfait."},
                {q: "Temps pour une action future certaine:", o: ["présent", "futur proche", "futur simple", "conditionnel"], c: 2, e: "Le futur simple = certitude."},
                {q: "'Quand j'étais petit': temps du verbe?", o: ["présent", "imparfait", "passé composé", "plus-que-parfait"], c: 1, e: "'Étais' est à l'imparfait."},
                {q: "Différence passé composé/imparfait:", o: ["aucune", "action ponctuelle/habitude", "formel/informel", "écrit/oral"], c: 1, e: "PC = ponctuel ; Imparfait = habitude."}
            ]
        };

        let stats = {total: 0, correct: 0, streak: 0, weaknesses: {}, completed: {}};
        let currentLesson = null, currentQuestionIndex = 0, sessionQuestions = [], sessionStats = {};

        function init() {
            const savedStats = localStorage.getItem('francaisIA_stats');
            if (savedStats) stats = JSON.parse(savedStats);
            updateDashboard();
            renderLessons();
        }

        function updateDashboard() {
            document.getElementById('totalQuestions').textContent = stats.total;
            document.getElementById('correctAnswers').textContent = stats.correct;
            const accuracy = stats.total > 0 ? Math.round((stats.correct / stats.total) * 100) : 0;
            document.getElementById('accuracyRate').textContent = accuracy + '%';
            document.getElementById('streak').textContent = stats.streak;

            const level = Math.floor(stats.total / 50);
            const progress = (stats.total % 50) * 2;
            document.getElementById('levelProgress').style.width = progress + '%';
            document.getElementById('levelProgress').textContent = progress + '%';

            const badge = document.getElementById('levelBadge');
            if (level >= 5) {
                badge.textContent = 'Avancé';
                badge.className = 'level-badge avance';
            } else if (level >= 2) {
                badge.textContent = 'Intermédiaire';
                badge.className = 'level-badge intermediaire';
            } else {
                badge.textContent = 'Débutant';
                badge.className = 'level-badge debutant';
            }

            updateRecommendations();
        }

        function updateRecommendations() {
            const container = document.getElementById('suggestions');
            const weakTopics = Object.entries(stats.weaknesses).sort((a, b) => b[1] - a[1]).slice(0, 1);

            if (weakTopics.length > 0) {
                const topic = LESSONS.find(l => l.id === weakTopics[0][0]);
                if (topic) {
                    container.innerHTML = '<strong>💡 Amélioration recommandée</strong><br>Pratiquez davantage <strong>' + topic.title + '</strong> pour renforcer vos compétences.';
                    return;
                }
            }

            if (stats.streak >= 5) {
                container.innerHTML = '<strong>🔥 Excellente série !</strong><br>Vous avez ' + stats.streak + ' bonnes réponses consécutives. Continuez ainsi !';
            } else if (stats.total === 0) {
                container.innerHTML = '<strong>👋 Bienvenue !</strong><br>Commencez par sélectionner un module ci-dessous pour débuter votre apprentissage.';
            } else {
                container.innerHTML = '<strong>📈 Continuez</strong><br>Vous avez traité ' + stats.total + ' questions. Excellent travail !';
            }
        }

        function renderLessons() {
            const grid = document.getElementById('lessonsGrid');
            grid.innerHTML = LESSONS.map(lesson => {
                const completed = stats.completed[lesson.id] || 0;
                const progressPercent = Math.min(Math.round((completed / 15) * 100), 100);
                return '<div class="lesson-card" onclick="startLesson(\''+lesson.id+'\')"><div class="lesson-icon">'+lesson.icon+'</div><div class="lesson-title">'+lesson.title+'</div><div class="lesson-description">'+lesson.description+'</div><div class="lesson-footer"><span class="lesson-difficulty difficulty-'+lesson.difficulty+'">'+lesson.difficulty.charAt(0).toUpperCase()+lesson.difficulty.slice(1)+'</span><span style="color:#6b7280;font-weight:600">'+progressPercent+'%</span></div></div>';
            }).join('');
        }

        function startLesson(lessonId) {
            currentLesson = lessonId;
            currentQuestionIndex = 0;
            sessionQuestions = [...QUESTIONS[lessonId]].sort(() => Math.random() - 0.5);
            sessionStats = {correct: 0, wrong: 0};
            document.getElementById('mainDashboard').style.display = 'none';
            document.getElementById('lessonContainer').classList.add('active');
            const lesson = LESSONS.find(l => l.id === lessonId);
            document.getElementById('currentLessonTitle').textContent = lesson.title;
            loadQuestion();
        }

        function loadQuestion() {
            if (currentQuestionIndex >= sessionQuestions.length) {
                showReport();
                return;
            }

            const question = sessionQuestions[currentQuestionIndex];
            document.getElementById('lessonProgressText').textContent = 'Question ' + (currentQuestionIndex + 1) + '/15';
            document.getElementById('questionArea').innerHTML = '<div class="question-card"><div class="question-header"><div class="question-number">'+(currentQuestionIndex+1)+'</div><div class="question-text"><h3>'+question.q+'</h3></div></div><div class="options-grid">'+question.o.map((option, index) => '<div class="option" onclick="checkAnswer('+index+','+question.c+')">'+String.fromCharCode(65+index)+'. '+option+'</div>').join('')+'</div><div class="explanation-box" id="explanation"><h4>💡 Explication</h4><p>'+question.e+'</p></div></div>';
            document.getElementById('nextBtn').style.display = 'none';
        }

        function checkAnswer(selected, correct) {
            const options = document.querySelectorAll('.option');
            options.forEach(opt => opt.style.pointerEvents = 'none');

            stats.total++;

            if (selected === correct) {
                options[selected].classList.add('correct');
                stats.correct++;
                stats.streak++;
                sessionStats.correct++;
            } else {
                options[selected].classList.add('wrong');
                options[correct].classList.add('correct');
                stats.streak = 0;
                sessionStats.wrong++;
                stats.weaknesses[currentLesson] = (stats.weaknesses[currentLesson] || 0) + 1;
            }

            document.getElementById('explanation').classList.add('show');
            document.getElementById('nextBtn').style.display = 'block';
            updateDashboard();
            localStorage.setItem('francaisIA_stats', JSON.stringify(stats));
        }

        function nextQuestion() {
            currentQuestionIndex++;
            loadQuestion();
        }

        function showReport() {
            const total = sessionStats.correct + sessionStats.wrong;
            const percent = Math.round((sessionStats.correct / total) * 100);
            let message = percent >= 90 ? '🏆 Excellent !' : percent >= 70 ? '⭐ Très bien !' : percent >= 50 ? '👍 Bien !' : '📚 À revoir';

            stats.completed[currentLesson] = (stats.completed[currentLesson] || 0) + sessionStats.correct;
            localStorage.setItem('francaisIA_stats', JSON.stringify(stats));

            document.getElementById('questionArea').style.display = 'none';
            document.getElementById('nextBtn').style.display = 'none';
            document.getElementById('performanceReport').innerHTML = '<div style="font-size:4em;margin-bottom:20px">'+message+'</div><div style="font-size:1.5em;color:#6b7280;margin-bottom:30px">Score : '+sessionStats.correct+'/'+total+' ('+percent+'%)</div><div style="display:flex;gap:15px;justify-content:center;flex-wrap:wrap"><button class="btn btn-primary" onclick="startLesson(\''+currentLesson+'\')">🔄 Recommencer</button><button class="btn btn-success" onclick="exitLesson()">🏠 Dashboard</button></div>';
            document.getElementById('performanceReport').classList.add('show');
        }

        function exitLesson() {
            document.getElementById('lessonContainer').classList.remove('active');
            document.getElementById('mainDashboard').style.display = 'block';
            document.getElementById('questionArea').style.display = 'block';
            document.getElementById('performanceReport').classList.remove('show');
            updateDashboard();
            renderLessons();
        }

        function showAbout() {
            document.getElementById('aboutModal').classList.add('show');
        }

        function closeAbout() {
            document.getElementById('aboutModal').classList.remove('show');
        }

        function exportData() {
            const data = {
                projet: 'FrançaisIA',
                institution: 'Université de Mostaganem',
                date: new Date().toISOString(),
                statistiques: stats
            };
            const blob = new Blob([JSON.stringify(data, null, 2)], {type: 'application/json'});
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'francaisia_donnees_'+new Date().toISOString().split('T')[0]+'.json';
            a.click();
            URL.revokeObjectURL(url);
            alert('✅ Données exportées avec succès !');
        }

        function resetData() {
            if (confirm('⚠️ Voulez-vous vraiment réinitialiser toutes vos données ?')) {
                localStorage.removeItem('francaisIA_stats');
                stats = {total: 0, correct: 0, streak: 0, weaknesses: {}, completed: {}};
                updateDashboard();
                renderLessons();
                alert('✅ Données réinitialisées !');
            }
        }

        window.onload = init;
    </script>
</body>
</html>
